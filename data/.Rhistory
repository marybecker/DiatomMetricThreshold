sl1<- -beta[1] / beta[2]
int2<-(beta0 + 1) / beta[2]
sl2<- -beta[1] / beta[2]
##Plot the hyperplane
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl1)+
geom_abline(intercept=int2,slope=sl2)
int<-(beta0 / beta[1])
sl<-(-beta[2] / beta[1])
int1<-(beta0 - 1) / beta[1]
sl1<- -beta[2] / beta[1]
int2<-(beta0 + 1) / beta[1]
sl2<- -beta[2] / beta[1]
##Plot the hyperplane
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl1)+
geom_abline(intercept=int2,slope=sl2)
ggplot(IND,aes(H,TP_MGL))+
geom_point(aes(colour=factor(TPGrp)))+
scale_y_log10()
names(IND)
x<-as.matrix(IND[,c(6)])
y<-IND[,8]
m<-IND[,c(6,8)]
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)))
pred<-predict(model,m)
table(pred=pred,true=m$TPGrp)# confusion matrix
summary(model)
beta<- drop(t(model$coefs)%*%x[model$index,])
beta0 <- model$rho
beta
beta0
ggplot(IND,aes(H,TP_MGL))+
geom_point(aes(colour=factor(TPGrp)))+
scale_y_log10()+
abline(intercept=beta0/beta,slope=beta)
ggplot(IND,aes(H,TP_MGL))+
geom_point(aes(colour=factor(TPGrp)))+
scale_y_log10()+
abline(intercept=beta0/beta,slope=- beta)
beta
beta0
table(pred=pred,true=m$TPGrp)# confusion matrix
plot(model,m)
plot(model,x)
plot(model,m$H)
x<-as.matrix(IND[,c(6)])
y<-IND[,8]
m<-IND[,c(6,8)]
##Run Linear SVM Model
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)))
pred<-predict(model,m)
table(pred=pred,true=m$TPGrp)# confusion matrix
plot(model,m)
names(m)
plot.svm(model,m)
plot.svm(model,m[,1])
plot.svm(model,m[1])
plot(model,m[,1])
plot(model,m)
x<-as.matrix(IND[,c(5,6)])
y<-IND[,8]
m<-IND[,c(5,6,8)]
##Run Linear SVM Model
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)))
pred<-predict(model,m)
table(pred=pred,true=m$TPGrp)# confusion matrix
beta<- drop(t(model$coefs)%*%x[model$index,])
beta0 <- model$rho
int<-(beta0 / beta[1])
sl<-(-beta[2] / beta[1])
int1<-(beta0 - 1) / beta[1]
sl1<- -beta[2] / beta[1]
int2<-(beta0 + 1) / beta[1]
sl2<- -beta[2] / beta[1]
##Plot the hyperplane
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl1)+
geom_abline(intercept=int2,slope=sl2)
x[model$index,]
View(IND)
IND <-  read.csv ("DiatomMetrics_GAM.csv",sep=",",header=TRUE)
IND<-IND[IND$ID!='S18882_2015',]
IND[is.na(IND)] <- 0
IND$TPGrp<-factor(ifelse(IND$TP_MGL<0.065,"low","high"))
x<-as.matrix(IND[,c(5,6)])
y<-IND[,8]
m<-IND[,c(5,6,8)]
##Run Linear SVM Model
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)))
pred<-predict(model,m)
table(pred=pred,true=m$TPGrp)# confusion matrix
int<-(beta0 / beta[1])
sl<-(-beta[2] / beta[1])
int1<-(beta0 - 1) / beta[1]
sl1<- -beta[2] / beta[1]
int2<-(beta0 + 1) / beta[1]
sl2<- -beta[2] / beta[1]
##Plot the hyperplane
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl1)+
geom_abline(intercept=int2,slope=sl2)
View(IND)
pred
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)),probability=TRUE)
pred<-predict(model,m)
pred
pred<-predict(model,m,probability=TRUE)
pred
table(pred=pred,true=m$TPGrp)# confusion matrix
x<-as.matrix(IND[,c(5,6)])
y<-IND[,8]
m<-IND[,c(5,6,8)]
##Run Linear SVM Model
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)),probability=TRUE)
pred<-predict(model,m,probability=TRUE)
table(pred=pred,true=m$TPGrp)# confusion matrix
beta<- drop(t(model$coefs)%*%x[model$index,])
beta0 <- model$rho
int<-(beta0 / beta[1])
sl<-(-beta[2] / beta[1])
int1<-(beta0 - 1) / beta[1]
sl1<- -beta[2] / beta[1]
int2<-(beta0 + 1) / beta[1]
sl2<- -beta[2] / beta[1]
##Plot the hyperplane
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl1)+
geom_abline(intercept=int2,slope=sl2)
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)))
pred<-predict(model,m,probability=TRUE)
table(pred=pred,true=m$TPGrp)# confusion matrix
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)))
pred<-predict(model,m)
table(pred=pred,true=m$TPGrp)# confusion matrix
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)),probability=TRUE)
pred<-predict(model,m,probability=TRUE)
pred
name(pred)
names(pred)
model<-svm(TPGrp~.,data=m,kernel="linear",cost=1,scale=FALSE,class.weights=(c("high"=4,"low"=1)))
pred<-predict(model,m)
table(pred=pred,true=m$TPGrp)# confusion matrix
beta<- drop(t(model$coefs)%*%x[model$index,])
beta0 <- model$rho
int<-(beta0 / beta[1])
sl<-(-beta[2] / beta[1])
int1<-(beta0 - 1) / beta[1]
sl1<- -beta[2] / beta[1]
int2<-(beta0 + 1) / beta[1]
sl2<- -beta[2] / beta[1]
##Plot the hyperplane
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl1)+
geom_abline(intercept=int2,slope=sl2)
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)
INDT <-  read.csv ("DiatomMetrics_2017.csv",sep=",",header=TRUE)
INDT[is.na(INDT)] <- 0
INDT$TPGrp<-factor(ifelse(INDT$TP_MGL<0.065,"low","high"))
INDT$R<-(INDT$H*10)/(INDT$H+INDT$L)
INDT$SH<-INDT$H*10
m2<-INDT[,c(5,6,7)]
pred2<- predict(model,m2)
table(pred=pred2,true=m2$TPGrp)# confusion matrix
INDT <-  read.csv ("DiatomMetrics_MSU.csv",sep=",",header=TRUE)
INDT[is.na(INDT)] <- 0
INDT$TPGrp<-factor(ifelse(INDT$TP_MGL<0.065,"low","high"))
m2<-INDT[,c(5,6,7)]
pred2<- predict(model,m2)
table(pred=pred2,true=m2$TPGrp)# confusion matrix
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl1)+
geom_abline(intercept=int2,slope=sl2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot(IND,aes(H,L))+
geom_point(aes(colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(IND,aes(H,L,colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
x[model,index,]
x[model$index,]
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(x[model$index,],aes(H,L,shape=21))
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
mindx<-as.dataframe(x[model$index,])
mindx<-as.data.frame(x[model$index,])
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(mindx,aes(H,L,shape=21))
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
names(mindx)
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(mindx,aes(H,L))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(data=mindx,aes(H,L))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(data=mindx,aes(H,L,shape=21))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(data=mindx,aes(H,L),shape=21)+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(data=mindx,aes(H,L),shape=21,size=5)+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(data=mindx,aes(H,L),shape=21,size=5)+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(data=mindx,aes(H,L),shape=21,size=5)+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
pred
INDT <-  read.csv ("DiatomMetrics_2017.csv",sep=",",header=TRUE)
INDT[is.na(INDT)] <- 0
INDT$TPGrp<-factor(ifelse(INDT$TP_MGL<0.065,"low","high"))
INDT$R<-(INDT$H*10)/(INDT$H+INDT$L)
INDT$SH<-INDT$H*10
m2<-INDT[,c(5,6,7)]
pred2<- predict(model,m2)
table(pred=pred2,true=m2$TPGrp)# confusion matrix
ggplot()+
geom_point(data=INDT,aes(H,L,colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
View(INDT)
ggplot()+
geom_point(data=INDT,aes(H,L,colour=factor(TPGrp)))+
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
geom_point(data=mindx,aes(H,L),shape=21,size=5)+#support points that determine the boundary
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
IND$TPGrp3<-factor(ifelse(IND$TP_MGL<=0.02,"low",ifelse(TP$TP_MGL>0.065,"high","medium")))
IND$TPGrp3<-factor(ifelse(IND$TP_MGL<=0.02,"low",ifelse(IND$TP_MGL>0.065,"high","medium")))
View(IND)
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp3)))+
geom_point(data=mindx,aes(H,L),shape=21,size=5)+#support points that determine the boundary
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
IND$TPGrp3<-factor(ifelse(IND$TP_MGL<0.04,"low",ifelse(IND$TP_MGL>0.065,"high","medium")))
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp3)))+
geom_point(data=mindx,aes(H,L),shape=21,size=5)+#support points that determine the boundary
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp3)))+
#geom_point(data=mindx,aes(H,L),shape=21,size=5)+#support points that determine the boundary
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp))+
#geom_point(data=mindx,aes(H,L),shape=21,size=5)+#support points that determine the boundary
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp))+
#geom_point(data=mindx,aes(H,L),shape=21,size=5)+#support points that determine the boundary
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
ggplot()+
geom_point(data=IND,aes(H,L,colour=factor(TPGrp)))+
#geom_point(data=mindx,aes(H,L),shape=21,size=5)+#support points that determine the boundary
xlim(0,1)+
ylim(0,1)+
theme(legend.position=c(0.75,0.75))+
geom_abline(intercept = int,slope=sl)+
geom_abline(intercept=int1,slope=sl,linetype=2)+
geom_abline(intercept=int2,slope=sl,linetype=2)+
labs(x="Rel Abund Tolerant Diatoms",
y="Rel Abund Senstitive Diatoms",
colour="TP GRP")
View(IND)
